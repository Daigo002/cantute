<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cantuta Peruana - Flor Nacional del Per√∫</title>
<style>
  :root{
    --radius: 15px;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    font-family: Georgia, "Times New Roman", serif;
    background: linear-gradient(135deg, #0f2027 0%, #203a43 30%, #2c5364 100%);
    color: #fff;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  /* p√©talos flotantes del fondo */
  .floating-petals {
    position: fixed; inset: 0;
    pointer-events: none;
    z-index: 1;
  }
  .petal {
    position: absolute;
    width: 12px;
    height: 20px;
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 50%, #d63031 100%);
    border-radius: 60% 20% 60% 20%;
    opacity: 0;
    animation: floatPetal 15s infinite linear;
    transform-origin: center;
  }
  @keyframes floatPetal {
    0%   { transform: translateY(100vh) translateX(0) rotate(0)    scale(0.5); opacity: 0; }
    10%  { opacity: 0.85; }
    90%  { opacity: 0.6; }
    100% { transform: translateY(-20vh) translateX(200px) rotate(720deg) scale(1.2); opacity: 0; }
  }

  /* layout */
  .container {
    position: relative;
    z-index: 10;
    min-height: 100vh;
    display: grid;
    grid-template-rows: auto 1fr auto;
  }
  header {
    padding: clamp(1rem, 3vw, 2rem);
    text-align: center;
    background: rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .title {
    font-size: clamp(1.8rem, 5vw, 2.6rem);
    font-weight: 700;
    line-height: 1.1;
    background: linear-gradient(45deg, #ffeaa7, #fab1a0, #fd79a8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    margin-bottom: .4rem;
  }
  .subtitle {
    font-size: clamp(.95rem, 2.3vw, 1.2rem);
    opacity: 0.85;
    font-style: italic;
  }

  .main {
    display: grid;
    place-items: center;
    padding: clamp(1rem, 3.5vw, 2.5rem);
  }
  .flower-card{
    position: relative;
    background: radial-gradient(ellipse at center, rgba(255,255,255,0.10) 0%, rgba(0,0,0,0.20) 100%);
    border-radius: 50%;
    padding: clamp(1.2rem, 4vw, 3rem);
    backdrop-filter: blur(15px);
    border: 2px solid rgba(255,255,255,0.12);
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
  }

  #cantuta-svg{
    width: min(88vw, 620px);
    height: min(88vw, 620px);
    filter: drop-shadow(0 10px 30px rgba(0,0,0,0.3));
    display:block;
  }

  /* Controles */
  .controls {
    position: fixed;
    top: 1rem; right: 1rem;
    display: flex; gap: .6rem;
    z-index: 20;
  }
  .btn {
    padding: .7rem 1.1rem;
    background: linear-gradient(45deg, #e17055, #d63031);
    border: none;
    border-radius: 999px;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    transition: transform .2s ease, box-shadow .2s ease;
    box-shadow: 0 5px 15px rgba(214, 48, 49, 0.35);
    font-size: .95rem;
    white-space: nowrap;
  }
  .btn:hover { transform: translateY(-2px) scale(1.04); box-shadow: 0 8px 25px rgba(214,48,49,.45); }

  /* Info */
  .info {
    margin: 1.2rem auto 2rem;
    max-width: 900px;
    width: calc(100% - 2rem);
    text-align: center;
    background: rgba(0,0,0,0.55);
    padding: 1rem 1.2rem;
    border-radius: var(--radius);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.12);
    font-size: clamp(.9rem, 2.2vw, 1rem);
  }

  /* Animaciones suaves */
  .wind-sway { animation: windSway 4s infinite ease-in-out; transform-origin: bottom center; }
  @keyframes windSway {
    0%,100%{ transform: rotate(0) translateX(0); }
    25%    { transform: rotate(1deg) translateX(3px); }
    50%    { transform: rotate(-.6deg) translateX(-2px); }
    75%    { transform: rotate(.8deg) translateX(2px); }
  }
  .petal-dance { animation: petalDance 3s infinite ease-in-out; transform-origin: center bottom; }
  @keyframes petalDance {
    0%,100%{ transform: scale(1) rotate(0); }
    33%    { transform: scale(1.05) rotate(2deg); }
    66%    { transform: scale(.985) rotate(-1deg); }
  }
  .stamen-wave{ animation: stamenWave 2.5s infinite ease-in-out; transform-origin: bottom; }
  @keyframes stamenWave {
    0%,100%{ transform: rotate(0deg); }
    50%    { transform: rotate(3deg); }
  }
  .fade-in { animation: fadeIn 1.2s ease-out; }
  @keyframes fadeIn { from {opacity:0; transform: scale(.92)} to {opacity:1; transform: scale(1)} }
  .glow { filter: drop-shadow(0 0 10px rgba(255, 107, 107, 0.6)); }

  /* Accesibilidad: reducir movimiento */
  @media (prefers-reduced-motion: reduce){
    * { animation: none !important; transition: none !important; }
  }

  /* Responsive extra */
  @media (max-width: 640px){
    .controls{ position: static; justify-content:center; margin: .8rem 0 0; }
    .container{ grid-template-rows: auto auto 1fr auto; }
  }
</style>
</head>
<body>
  <div class="floating-petals" id="petals-container"></div>

  <div class="container">
    <header>
      <h1 class="title">üå∫ Cantuta Peruana</h1>
      <p class="subtitle">Cantua buxifolia ‚Äî Flor Nacional del Per√∫</p>
    </header>

    <div class="controls">
      <button class="btn" id="regenerate">üå∏ Nueva Flor</button>
      <button class="btn" id="toggle-petals">‚ùÑÔ∏è P√©talos</button>
    </div>

    <main class="main">
      <div class="flower-card">
        <svg id="cantuta-svg" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg" aria-label="Ilustraci√≥n de Cantuta"></svg>
      </div>
    </main>

    <div class="info">
      <p><strong>La Cantuta</strong> fue venerada por los incas y hoy es s√≠mbolo nacional del Per√∫. Se reconoce por sus flores tubulares colgantes, de rojo intenso y garganta amarilla.</p>
    </div>
  </div>

<script>
(function () {
  const svg = document.getElementById('cantuta-svg');
  const regenerateBtn = document.getElementById('regenerate');
  const petalsBtn = document.getElementById('toggle-petals');
  const petalsContainer = document.getElementById('petals-container');

  let petalsActive = true;

  /* ---------- Utilidades ---------- */
  function random(min, max) { return Math.random() * (max - min) + min; }
  function debounce(fn, wait){
    let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn.apply(null,args), wait); };
  }

  /* ---------- P√©talos flotantes ---------- */
  function createFloatingPetals(count){
    for(let i=0;i<count;i++){
      const petal = document.createElement('div');
      petal.className = 'petal';
      petal.style.left = Math.random()*100 + '%';
      petal.style.animationDelay = Math.random()*15 + 's';
      petal.style.animationDuration = (12 + Math.random()*6) + 's';
      const hue = 350 + Math.random()*20;
      petal.style.background = `linear-gradient(135deg, hsl(${hue},80%,65%) 0%, hsl(${hue-10},85%,55%) 50%, hsl(${hue-20},90%,45%) 100%)`;
      petalsContainer.appendChild(petal);
    }
  }
  function togglePetals(){
    petalsActive = !petalsActive;
    petalsContainer.style.display = petalsActive ? 'block' : 'none';
    petalsBtn.textContent = petalsActive ? '‚ùÑÔ∏è P√©talos' : 'üå∏ P√©talos';
  }

  /* ---------- Gradientes ---------- */
  function createGradients(){
    const ns = 'http://www.w3.org/2000/svg';
    const defs = document.createElementNS(ns, 'defs');

    // tubo rojo
    const tubeGradient = document.createElementNS(ns,'linearGradient');
    tubeGradient.id = 'tubeGradient';
    tubeGradient.setAttribute('x1','0%'); tubeGradient.setAttribute('y1','0%');
    tubeGradient.setAttribute('x2','100%'); tubeGradient.setAttribute('y2','100%');
    const hue = random(345,360);
    [
      ['0%'  , `hsl(${hue},85%,60%)`],
      ['30%' , `hsl(${hue-5},90%,55%)`],
      ['70%' , `hsl(${hue-10},95%,50%)`],
      ['100%', `hsl(${hue-15},95%,45%)`],
    ].forEach(([o,c])=>{
      const s = document.createElementNS(ns,'stop'); s.setAttribute('offset',o); s.setAttribute('stop-color',c); tubeGradient.appendChild(s);
    });

    // garganta dorada
    const throat = document.createElementNS(ns,'radialGradient');
    throat.id='throatGradient';
    throat.setAttribute('cx','50%'); throat.setAttribute('cy','50%'); throat.setAttribute('r','50%');
    [['0%','#ffeaa7'],['50%','#fdcb6e'],['100%','#e17055']].forEach(([o,c])=>{
      const s = document.createElementNS(ns,'stop'); s.setAttribute('offset',o); s.setAttribute('stop-color',c); throat.appendChild(s);
    });

    // hojas
    const leaf = document.createElementNS(ns,'linearGradient');
    leaf.id='leafGradient';
    leaf.setAttribute('x1','0%'); leaf.setAttribute('y1','0%');
    leaf.setAttribute('x2','100%'); leaf.setAttribute('y2','100%');
    const c1 = `hsl(${random(120,140)},60%,45%)`;
    const c2 = `hsl(${random(110,130)},55%,35%)`;
    const c3 = `hsl(${random(100,120)},50%,25%)`;
    [['0%',c1],['50%',c2],['100%',c3]].forEach(([o,c])=>{
      const s = document.createElementNS(ns,'stop'); s.setAttribute('offset',o); s.setAttribute('stop-color',c); leaf.appendChild(s);
    });

    defs.appendChild(tubeGradient);
    defs.appendChild(throat);
    defs.appendChild(leaf);
    return defs;
  }

  /* ---------- Flor Cantuta ---------- */
  function createCantutaFlower(){
    const ns = 'http://www.w3.org/2000/svg';
    const g = document.createElementNS(ns,'g');
    g.classList.add('fade-in','wind-sway');

    const isMobile = window.innerWidth <= 768;
    g.setAttribute('transform', `scale(${isMobile ? 0.9 : 1})`);

    // tallo
    const stem = document.createElementNS(ns,'path');
    const stemPath = `M 200 380 C 200 320 ${190 + random(-20,20)} 250 ${200 + random(-15,15)} 150`;
    stem.setAttribute('d', stemPath);
    stem.setAttribute('stroke', `hsl(${random(100,120)}, 50%, 30%)`);
    stem.setAttribute('stroke-width', isMobile ? '6' : '8');
    stem.setAttribute('stroke-linecap','round');
    stem.setAttribute('fill','none');
    g.appendChild(stem);

    // hojas
    const numLeaves = Math.floor(random(3, isMobile ? 4 : 5));
    for(let i=0;i<numLeaves;i++){
      const leaf = document.createElementNS(ns,'path');
      const y = 300 - i*40 + random(-15,15);
      const x = 200 + random(-25,25);
      const side = i % 2 === 0 ? 1 : -1;
      const size = random(isMobile?20:25, isMobile?30:35);
      const d = [
        `M ${x} ${y}`,
        `C ${x + side*size} ${y - 10}`,
        `${x + side*size} ${y - size + 10}`,
        `${x} ${y - size}`,
        `C ${x - side*size*0.3} ${y - size + 10}`,
        `${x - side*size*0.3} ${y - 10}`,
        `${x} ${y} Z`
      ].join(' ');
      leaf.setAttribute('d', d);
      leaf.setAttribute('fill','url(#leafGradient)');
      leaf.setAttribute('stroke', 'hsl(120,40%,20%)');
      leaf.setAttribute('stroke-width', isMobile ? '1' : '1.5');
      leaf.classList.add('wind-sway');
      leaf.style.animationDelay = `${i*0.3}s`;
      g.appendChild(leaf);
    }

    // flores (1‚Äì3 en m√≥vil, 1‚Äì4 en desktop)
    const numFlowers = Math.floor(random(1, isMobile ? 3 : 4));
    for(let f=0; f<numFlowers; f++){
      const flowerGroup = document.createElementNS(ns,'g');
      const flowerX = 200 + random(-30, 30);
      const flowerY = 120 + f*25 + random(-10,10);

      // pedicelo
      const pedicel = document.createElementNS(ns,'path');
      const curve = random(-10,10);
      pedicel.setAttribute('d', `M ${flowerX} ${flowerY + 20} Q ${flowerX + curve} ${flowerY + 10} ${flowerX} ${flowerY}`);
      pedicel.setAttribute('stroke', 'hsl(120,40%,35%)');
      pedicel.setAttribute('stroke-width', isMobile ? '2' : '3');
      pedicel.setAttribute('fill','none');
      flowerGroup.appendChild(pedicel);

      // c√°liz
      const calyx = document.createElementNS(ns,'g');
      calyx.setAttribute('transform', `translate(${flowerX}, ${flowerY})`);
      for(let i=0;i<5;i++){
        const sepal = document.createElementNS(ns,'path');
        const angle = i*72 + random(-5,5);
        const sepalPath = `M 0 0 Q ${isMobile?6:8} -5 ${isMobile?5:6} -15 Q 0 -12 0 0`;
        sepal.setAttribute('d', sepalPath);
        sepal.setAttribute('fill', `hsl(${random(110,130)},60%,40%)`);
        sepal.setAttribute('stroke', 'hsl(120,50%,25%)');
        sepal.setAttribute('stroke-width', '1');
        sepal.setAttribute('transform', `rotate(${angle})`);
        calyx.appendChild(sepal);
      }
      flowerGroup.appendChild(calyx);

      // tubo rojo
      const tube = document.createElementNS(ns,'path');
      const tubeLength = random(isMobile?35:40, isMobile?45:55);
      const tubeWidth  = random(isMobile?7:8 , isMobile?10:12);
      const mouthWidth = tubeWidth * random(1.5, 2);
      const tubePath = [
        `M ${flowerX - tubeWidth/2} ${flowerY}`,
        `C ${flowerX - tubeWidth/2} ${flowerY - tubeLength*.3}`,
        `${flowerX - mouthWidth/2} ${flowerY - tubeLength*.8}`,
        `${flowerX - mouthWidth/2} ${flowerY - tubeLength}`,
        `L ${flowerX + mouthWidth/2} ${flowerY - tubeLength}`,
        `C ${flowerX + mouthWidth/2} ${flowerY - tubeLength*.8}`,
        `${flowerX + tubeWidth/2} ${flowerY - tubeLength*.3}`,
        `${flowerX + tubeWidth/2} ${flowerY} Z`
      ].join(' ');
      tube.setAttribute('d', tubePath);
      tube.setAttribute('fill','url(#tubeGradient)');
      tube.setAttribute('stroke','rgba(0,0,0,.3)');
      tube.setAttribute('stroke-width','1');
      tube.classList.add('glow');
      flowerGroup.appendChild(tube);

      // p√©talos de la boca
      const petalGroup = document.createElementNS(ns,'g');
      petalGroup.setAttribute('transform', `translate(${flowerX}, ${flowerY - tubeLength})`);
      petalGroup.classList.add('petal-dance');
      petalGroup.style.animationDelay = `${f * .5}s`;
      for(let i=0;i<5;i++){
        const petal = document.createElementNS(ns,'path');
        const angle = i*72 + random(-8,8);
        const petalLength = random(isMobile?10:12, isMobile?15:18);
        const petalWidth  = random(isMobile?5:6 , isMobile?8:9);
        const d = [
          `M 0 0`,
          `Q ${-petalWidth/2} ${-petalLength*.5}`, `${-petalWidth/3} ${-petalLength}`,
          `Q 0 ${-petalLength-2}`, `${petalWidth/3} ${-petalLength}`,
          `Q ${petalWidth/2} ${-petalLength*.5} 0 0 Z`
        ].join(' ');
        petal.setAttribute('d', d);
        petal.setAttribute('fill','url(#tubeGradient)');
        petal.setAttribute('stroke','rgba(0,0,0,.2)');
        petal.setAttribute('stroke-width','.5');
        petal.setAttribute('transform', `rotate(${angle})`);
        petalGroup.appendChild(petal);
      }
      flowerGroup.appendChild(petalGroup);

      // garganta dorada
      const throat = document.createElementNS(ns,'circle');
      throat.setAttribute('cx', flowerX);
      throat.setAttribute('cy', flowerY - tubeLength);
      throat.setAttribute('r', mouthWidth * .35);
      throat.setAttribute('fill','url(#throatGradient)');
      throat.classList.add('glow');
      flowerGroup.appendChild(throat);

      // estambres
      const stamens = document.createElementNS(ns,'g');
      stamens.setAttribute('transform', `translate(${flowerX}, ${flowerY - tubeLength})`);
      stamens.classList.add('stamen-wave');
      stamens.style.animationDelay = `${f * .3}s`;
      const n = Math.floor(random(4,6));
      for(let i=0;i<n;i++){
        const angle = (i/n)*360 + random(-10,10);
        const length = random(isMobile?6:8, isMobile?12:15);
        const x = Math.cos(angle * Math.PI/180) * 2;
        const y = -length;

        const filament = document.createElementNS(ns,'line');
        filament.setAttribute('x1','0'); filament.setAttribute('y1','0');
        filament.setAttribute('x2',x);    filament.setAttribute('y2',y);
        filament.setAttribute('stroke','#8B4513');
        filament.setAttribute('stroke-width', isMobile ? '1' : '1.5');
        stamens.appendChild(filament);

        const anther = document.createElementNS(ns,'ellipse');
        anther.setAttribute('cx',x); anther.setAttribute('cy',y);
        anther.setAttribute('rx', isMobile ? '1.5' : '2');
        anther.setAttribute('ry', isMobile ? '2.5' : '3');
        anther.setAttribute('fill','#FFD700');
        anther.setAttribute('stroke','#B8860B');
        anther.setAttribute('stroke-width','.5');
        stamens.appendChild(anther);
      }
      flowerGroup.appendChild(stamens);

      g.appendChild(flowerGroup);
    }

    return g;
  }

  /* ---------- Render ---------- */
  function render(){
    svg.innerHTML = '';
    svg.appendChild(createGradients());
    svg.appendChild(createCantutaFlower());
  }

  /* ---------- Responsive / Optimizaci√≥n ---------- */
  function optimizeForMobile(){
    const isMobile = window.innerWidth <= 768;
    if(isMobile && window.devicePixelRatio <= 1){
      const style = document.createElement('style');
      style.textContent = `
        .wind-sway, .petal-dance, .stamen-wave { animation-duration: 6s !important; }
        .petal { animation-duration: 20s !important; }
      `;
      document.head.appendChild(style);
    }
  }

  function handleResize(){
    const isMobile = window.innerWidth <= 768;
    const targetPetals = isMobile ? 15 : 25;
    if (petalsContainer.children.length !== targetPetals){
      petalsContainer.innerHTML = '';
      if (petalsActive) createFloatingPetals(targetPetals);
    }
  }

  /* ---------- Eventos ---------- */
  regenerateBtn.addEventListener('click', render);
  petalsBtn.addEventListener('click', togglePetals);
  window.addEventListener('resize', debounce(handleResize, 250));
  window.addEventListener('orientationchange', () => setTimeout(handleResize, 400));

  // Pausar animaciones cuando la pesta√±a no est√° visible
  document.addEventListener('visibilitychange', () => {
    const els = document.querySelectorAll('.wind-sway, .petal-dance, .stamen-wave, .petal');
    const state = document.hidden ? 'paused' : 'running';
    els.forEach(el => el.style.animationPlayState = state);
  });

  /* ---------- Inicio ---------- */
  optimizeForMobile();
  createFloatingPetals(window.innerWidth <= 768 ? 15 : 25);
  render();
})();
</script>
</body>
</html>
